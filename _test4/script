tst_verbosity

# This test checks if Ice-Mods vanish after single zplugin invocation

zinit ice depth"1" if"(( 0 ))"
zinit light z-shell/ice-order
zinit light z-shell/ice-order

local PREV_PWD="$PWD"
zinit cd z-shell/ice-order

local -a lines
lines=( "${(f@)"$( command git log --oneline --max-count=2 )"}" )

cd "$PREV_PWD"
print -r -- ${#lines[@]} > answer/line_count

# No static ice should be gathered when if-condition is not meet
print -rl -- "${(kv)ZINIT_SICE[@]}" > answer/static_ice

# Not-neat adaptation of ice-order.plugin.zsh behavior
command rm -f answer/file.lst

# vim:ft=zsh
